set -eu
test_setup
source /usr/local/lib/libemu

cd /tmp/emu/test-source
echo "exit_if_no_dir_permissions /tmp/emu/test-source"
exit_if_no_dir_permissions /tmp/emu/test-source
echo "exit_if_no_dir_permissions ../test-source"
exit_if_no_dir_permissions ../test-source
echo "exit_if_no_dir_permissions ."
exit_if_no_dir_permissions .

# Fail tests
sudo mkdir -pv /tmp/emu/root-dir
cd /tmp/emu/root-dir

set +e
echo "exit_if_no_dir_permissions /tmp/emu/root-dir"
exit_if_no_dir_permisions /tmp/emu/root-dir
if ! (( $? ))
then
    exit 5
fi

echo "exit_if_no_dir_permissions ../root-dir"
exit_if_no_dir_permisions ../root-dir
if ! (( $? ))
then
    exit 5
fi

echo "exit_if_no_dir_permissions"
exit_if_no_dir_permisions
if ! (( $? ))
then
    exit 5
fi

sudo rmdir -fv /tmp/emu/root-dir
set -e

test_teardown
