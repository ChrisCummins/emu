#!/bin/bash

set -ex
test_setup

version="$(emu --version)"
exec="$(find @prefix@/bin -type f -name 'emu*' -printf '%f\n')"

# Ensure we have some executables to test.
test -n "$exec" || { echo 'No bins found!'; exit 2; }

for bin in $exec; do
    e=$(basename $bin)

    # emu-command --version
    $e --version > $e.version
    assert_strings_match "$e.version" "$version"
    rm -f $e.version

    # emu command --version
    emu ${e:4} --version > $e.version
    assert_strings_match "$e.version" "$version"
    rm -f $e.version
done

test_teardown
