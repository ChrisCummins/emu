set -ex
test_setup

msg="Hello, World!"
exec_hook=.emu/hooks/exec/test.post
init_hook=.emu/hooks/init/test.post
tmp=tmp

cd $EMU_TEST_DIR
emu init
mkdir -pv $(dirname $init_hook)

# First we test exec hooks.
echo 'echo '"$msg" > $exec_hook
chmod +x $exec_hook
emu init > $tmp
output="$(cat $tmp | tail -n1)"
assert_strings_match "$msg" "$output"
rm -f $exec_hook

# Now we test command-specific hooks.
echo 'echo '"$msg" > $init_hook
chmod +x $init_hook
emu init > $tmp
output="$(cat $tmp | tail -n1)"
assert_strings_match "$msg" "$output"
rm -f $init_hook

test_teardown
